name: Build and deploy to Dockerhub on commit

on:
    push:
        branches: 
            - master

jobs:
    Build-and-push-to-dockerhub:
        runs-on: ubuntu-latest
        steps:
           - name: checkout repo
             uses: actions/checkout@v2

           - name: Log in to dockerhub
             uses: docker/login-action@v1
             with: 
                username: ${{ secrets.DOCKER_USERNAME }}
                password: ${{ secrets.DOCKER_PASSWORD }}

           - name: Build and push docker image
             uses: docker/build-push-action@v2
             with: 
                context: .
                file: ./docker/Dockerfile.user
                push: true
                tags: nishta03/wallet-user-app:latest

           - name: Verify pushed image
             run: docker pull nishta03/wallet-user-app:latest


